(function(s,a,c,u,t){"use strict";const f=u.findByName("RowManager"),p=u.findByProps("isIgnoredUser"),r="HideIgnoredMessages";p?.isIgnoredUser||t.logger.error(`[${r}] Could not find isIgnoredUser in RelationshipStore`);function S(n,g){let o={id:"",type:0,content:"",channel_id:g.id,author:{id:"",username:"",avatar:"",discriminator:"",publicFlags:0,avatarDecoration:null},attachments:[],embeds:[],mentions:[],mention_roles:[],pinned:!1,mention_everyone:!1,tts:!1,timestamp:"",edited_timestamp:null,flags:0,components:[]};return typeof n=="string"?o.content=n:o={...o,...n},o}const i=function(n){return p?.isIgnoredUser?.(n)};let l=[];const h=function(){try{const n=c.before("dispatch",a.FluxDispatcher,function(o){let[e]=o;if(e.type==="LOAD_MESSAGES_SUCCESS"&&(e.messages=e.messages.filter(function(d){return!i(d?.author?.id)})),e.type==="MESSAGE_CREATE"||e.type==="MESSAGE_UPDATE"){const d=e.message;i(d?.author?.id)&&(e.channelId="0")}});l.push(n);const g=c.before("generate",f.prototype,function(o){let[e]=o;i(e.message?.author?.id)&&(e.renderContentOnly=!0,e.message.content=null,e.message.reactions=[],e.message.canShowComponents=!1,e.rowType===2&&(e.roleStyle="",e.text="[Temp] Ignored message. Reloading should fix.",e.revealed=!1,e.content=[]))});l.push(g),t.logger.log(`${r} loaded.`)}catch(n){t.logger.error(`[${r} Error]`,n)}};var m={onLoad:function(){t.logger.log(`Loading ${r}...`);for(let n of["MESSAGE_CREATE","MESSAGE_UPDATE"])t.logger.log(`Dispatching ${n} to enable action handler.`),a.FluxDispatcher.dispatch({type:n,message:S("PLACEHOLDER",{id:"0"})});for(let n of["LOAD_MESSAGES","LOAD_MESSAGES_SUCCESS"])t.logger.log(`Dispatching ${n} to enable action handler.`),a.FluxDispatcher.dispatch({type:n,messages:[]});h()},onUnload:function(){t.logger.log(`Unloading ${r}...`);for(let n of l)n();t.logger.log(`${r} unloaded.`)}};return s.default=m,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta);
