(function(g,d,c,u,o){"use strict";const S=u.findByName("RowManager"),h=u.findByProps("renderIgnoredMessages"),p=u.findByProps("isIgnoredUser"),r="HideIgnoredMessages";p?.isIgnoredUser||o.logger.error(`[${r}] Could not find isIgnoredUser in RelationshipStore`);function E(n,f){let s={id:"",type:0,content:"",channel_id:f.id,author:{id:"",username:"",avatar:"",discriminator:"",publicFlags:0,avatarDecoration:null},attachments:[],embeds:[],mentions:[],mention_roles:[],pinned:!1,mention_everyone:!1,tts:!1,timestamp:"",edited_timestamp:null,flags:0,components:[]};return typeof n=="string"?s.content=n:s={...s,...n},s}const a=function(n){return p?.isIgnoredUser?.(n)};let l=[];const m=function(){try{const n=c.before("dispatch",d.FluxDispatcher,function(i){let[e]=i;if(e.type==="LOAD_MESSAGES_SUCCESS"&&(e.messages=e.messages.filter(function(t){return!a(t?.author?.id)})),e.type==="MESSAGE_CREATE"||e.type==="MESSAGE_UPDATE"){const t=e.message;a(t?.author?.id)&&(e.channelId="0")}});l.push(n);const f=c.before("generate",S.prototype,function(i){let[e]=i;a(e.message?.author?.id)&&(e.renderContentOnly=!0,e.message.content=null,e.message.reactions=[],e.message.canShowComponents=!1,e.rowType===2&&(e.roleStyle="",e.text="[Temp] Ignored message. Reloading should fix.",e.revealed=!1,e.content=[]))});l.push(f);const s=c.before("renderIgnoredMessages",h,function(i){let[e]=i;if(Array.isArray(e)){const t=e.filter(function(A){return!a(A?.author?.id)});return t.length===0?[t]:[t]}});l.push(s),o.logger.log(`${r} loaded.`)}catch(n){o.logger.error(`[${r} Error]`,n)}};var y={onLoad:function(){o.logger.log(`Loading ${r}...`);for(let n of["MESSAGE_CREATE","MESSAGE_UPDATE"])o.logger.log(`Dispatching ${n} to enable action handler.`),d.FluxDispatcher.dispatch({type:n,message:E("PLACEHOLDER",{id:"0"})});for(let n of["LOAD_MESSAGES","LOAD_MESSAGES_SUCCESS"])o.logger.log(`Dispatching ${n} to enable action handler.`),d.FluxDispatcher.dispatch({type:n,messages:[]});m()},onUnload:function(){o.logger.log(`Unloading ${r}...`);for(let n of l)n();o.logger.log(`${r} unloaded.`)}};return g.default=y,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta);
